2010.06.08 11:00
TPD Controller
The TPD Controller linearly ramps and holds the temperature of a sample through the use of a closed-loop control.  This involves measuring the temperature of the sample with a pyrometer, calculating the temperature error, and heating the sample resistively using a current calculated by a PID algorithm.  Data about time and temperature are recorded so that the temperature schedule can be compared with RGA data to perform temperature programmed desorption.

==User Input==
At any time, the "Experiment Setup" metadata can be changed.  Before the sample is heated, the hardware setup, PID tuning parameters, and temperature schedule must be configured.  These cannot be changed once the "RUN" button is pressed, until the run is ended.  The values for the temperature, current, voltage, and power limits cannot be set above the maximum value shown, or below 0.

==Heating the Sample==
Once the hardware parameters are entered and the experiment is physically set up, the "RUN" button can be pressed to start the sample heating.  As long as there are no errors while connecting to the DAQ board and the power supply, the PID algorithm will immediately begin running and the sample will heat.  Every 3 ms, a new temperature reading will be obtained, the PID algorithm will run, and a new current will be outputted to the power supply.  The temperature data will be passed through a running average filter to reduce noise.  In addition, readings of actual current and voltage outputted by the power supply will be read.  At every 3 ms interval, date, elapsed time [s], temperature setpoint [C], current setpoint [A], sample temperature [C], current [A], and voltage [V] will be recorded. The chart displays sample temperature, temperature setpoint, and current as a function of time.  

At any time, the "STOP" button can be pressed to stop the heating.  The only restriction actually imposed on the system by the limits selected in "Hardware Setup" is the current outputted by the power supply.  If the value for current calculated by the PID algorithm is higher than the maximum current or lower than 0, the value will be coerced into the acceptable range.  The "Over Temperature", "Over Current", "Over Power" and "Over Voltage" lights indicate that the temperature, current, power, or voltage are over the selected limit, respectively.  In any of these cases, the program will not shut off automatically; the "STOP" button must be pressed by the user.  The "Current at Max Value" light indicates that the current is at its maximum value, and that the physical setup might not be able to heat the sample to the selected setpoint subjected to the current limit.  

==Saving Data==
Once a run is over, the collected data can be saved as a text file by clicking "SAVE".  This will prompt the user for a filepath.  A new file will be created, or an existing file will be replaced.  Data is saved in four sections: experiment metadata, input parameters, temperature schedule, and data.  Each section is separated by an empty line.  In the experiment metadata and input parameters sections, every line has a label and respective data separated by two colons.  [Insert temperature schedule format here]  The data is formatted in columns delimited by tabs.  The first line is the titles, and all subsequent lines are the data.  Included are date, elapsed time [s], temperature setpoint [C], current setpoint [A], sample temperature [C], current [A], and voltage [V].  

==Resetting==
To perform another run without closing and restarting the program, "RESET" can be used.  This will clear all of the data structures that collect data while the sample is being heated, as well as all charts and indicators.  It will not reset the input parameters or metadata.
